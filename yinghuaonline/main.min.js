!function(){function e(){window.console&&window.console.log&&console.log(...arguments)}function t(){for(const e of arguments)if($(".output :last-child .inline-block").text()===e.toString()){let e=parseInt($(".output :last-child .count").text())||0;$(".output :last-child .count").text(e+1),$(".output :last-child .count").removeClass("hidden")}else $(".output").append(`<li><div class="inline-block">${e}</div><span class="count hidden"></span></li>`);$(".output").scrollTop($(".output")[0].scrollHeight)}function n(e,t=null){let n=window.location.search.substring(1);null!=t&&(t.substr(t.indexOf("?")+1),n=t.substr(t.indexOf("?")+1));const o=n.split("&");for(let t=0;t<o.length;t++){const n=o[t].split("=");if(n[0]===e)return n[1]}return!1}function o(e){let t=document.cookie.split("; ");for(let n=0;n<t.length;n++){let o=t[n].split("=");if(o[0]===e)return o[1]}return""}const i={set:function(e,t){if(window.localStorage)window.localStorage.setItem(e,t);else{var n=new Date;n.setTime(n.getTime()+2592e6),document.cookie=e+"="+escape(t)+";expires="+n.toGMTString()}},get:function(e){if(window.localStorage)return window.localStorage.getItem(e);var t,n=new RegExp("(^| )"+e+"=([^;]*)(;|$)");return(t=document.cookie.match(n))?unescape(t[2]):null},del:function(e){if(window.localStorage)return window.localStorage.removeItem(e);var t=new Date;t.setTime(t.getTime()-1);var n=this.get(e);null!=n&&(document.cookie=e+"="+n+";expires="+t.toGMTString())}},r={player:null,node_list:[],current_node_id:0,course_id:0,main_interval:null,initialize:function(){this.player=d,this.current_node_id=parseInt(n("nodeId")),this.course_id=this.get_course_id(),this.get_node_list().then((e=>{this.node_list=e,$("#node-count").text(this.node_list.length)})),this.get_node(this.current_node_id).then((e=>{const t=setInterval((()=>{this.player.time>=parseInt(e.study_total.duration)&&clearInterval(t),this.player.videoSeek(e.study_total.duration)}),1500)})),$("#course-id").text(this.course_id),$("#node-id").text(this.current_node_id),$("#course-title").text($(".detmain-navlist .group .list .item a.on").text());const o=setInterval((()=>{this.player.getMetaDate()?.duration&&$("#course-duration").text(this.player.getMetaDate()?.duration+"秒")&&clearInterval(o)}),1e3);window.console&&window.console.log&&console.clear(),e("%c 傲星英华学堂网课助手 %c https://www.aoaostar.com ","color: #fadfa3; background: #030307; padding:5px 0;","background: #fadfa3; padding:5px 0;"),e(`%c 当前课程ID：${this.course_id} %c 章节ID：${this.current_node_id}`,"background: #35495e; padding: 4px; border-radius: 3px 0 0 3px; color: #fff","background: #41b883; padding: 4px; border-radius: 0 3px 3px 0; color: #fff"),e("%c 脚本加载完成 当前时间："+(new Date).toLocaleString(),"color: #fff; margin: 1em 0; padding: 5px 0; background: #636e72;"),t("脚本加载完成 当前时间："+(new Date).toLocaleString())},main:function(){if(!this.judgement_state())return;let e=this;null==document.getElementById("videoContent")&&e.is_over()&&t("恭喜你，已全部刷完"),this.main_interval=setInterval((()=>{t("播放状态检查，是否播放完成："+l),!0===l&&e.over()}),3e3)},get_course_id:function(){let e=document.querySelector(".wrapper .curPlace .center");return null==e?(e=window.location.href,this.course_id=n("courseId",e)):this.course_id=n("courseId",e.lastChild.href),!1===n("courseId")&&(window.location.href=this.get_full_url({id:this.current_node_id})),this.course_id},over:function(){if(t("播放完成"),t("视频长度为"+this.player.getMetaDate().duration+"秒"),this.is_over())t("恭喜你，已全部刷完"),clearInterval(this.main_interval);else{t("2秒后跳转下一部");let e=this;setTimeout((function(){window.location.href=e.get_full_url(e.get_new_node())}),2e3)}},judgement_state(){let e=this;return null!=document.getElementById("error-main")?"章节数据有误,联系老师!"===document.querySelector("#error-main .name").innerText?(t("章节数据有误,准备跳转下一部"),setTimeout((function(){window.location.href=this.get_full_url(this.get_new_node())}),2e3),!1):"当前章节尚未解锁，请先学完上一个视频"===document.querySelector("#error-main .name").innerText&&(t("当前章节尚未解锁，准备跳转上一部"),setTimeout((function(){window.location.href=e.get_full_url(e.get_new_node())}),2e3),!1):this.node_list[this.node_list.length-1]===this.current_node_id?(t("恭喜你，当前为最后一课"),!0):null!=document.getElementById("videoContent")||(t("当前页面没有发现播放信息，准备跳转下一部"),setTimeout((function(){window.location.href=e.get_full_url(e.get_new_node())}),2e3),!1)},get_node_list:function(){return $.post("/api/course/chapter.json",{courseId:this.course_id,token:o("token")}).then((e=>{let t=[];for(const n of e.result.list)for(const e of n.nodeList)e.tabVideo&&t.push(e);return t}))},get_new_node:function(){for(const e of this.node_list)if(2!==e.videoState)return e;return t("获取最新未学视频失败，跳转第一课"),this.node_list[0]},get_list_node:function(e){console.log(this.node_list);for(const t of this.node_list)if(t.id!==e)return t;return t("获取最新未学视频失败，跳转最新课"),this.get_new_node()},get_node:function(e){return $.post("/api/node/video.json",{nodeId:e,token:o("token")}).then((e=>e.result.data))},is_over:function(){return this.node_list[this.node_list.length-1].id===this.current_node_id},get_full_url:function(e){return`${window.location.origin}/user/node?courseId=${this.course_id}&nodeId=${e.id}&t=${(new Date).getTime()}`}};let d=null,l=!1;var a=$("#video-file").val()||"",s=$("#video-nodeId").val()||"",u=$("#user-id").val()||"0",c=$("#study-state").val()||0;c=parseInt(c);var p="/user/node/study",f=0,g=0,h=0,_="stop",w="node_"+u+"_"+s;window.setInterval((function(){i.set("node_play_"+u,s)}),567),window.setInterval((function(){i.get("node_play_"+u);"playing"===_&&g++}),1e3);var m=2===c,v=null,y="",I=function(e,n){h=g;let o={nodeId:s,studyId:f,studyTime:g};n&&(n.length>4&&(n=n.substr(0,4)),o.code=n+y),void 0!==e&&1===e&&g<1&&(o.studyTime=1),$.ajax({method:"post",url:p,data:o,dataType:"json"}).then((e=>(n&&(e.status?t("验证码正确"):t("验证码错误")),e.status&&(f=e.studyId,n?(_="playing",d.videoPlay()):"提交学时成功!"!==e.msg&&(t(`提交学时异常，${e.msg}，2秒后刷新页面`),setTimeout((()=>{window.location.reload()}),2e3))),e))).then((e=>{e.need_code&&(_="pause",d.videoPause(),null===v&&(v=1,t(e.msg),t("识别验证码中，请稍后，可能需要多次请求才能成功，稍安勿躁"),fetch("/service/code?r="+Math.random()).then((function(e){return e.blob()})).then((e=>{let n=new FormData;n.append("file",e),fetch("https://api.opop.vip/captcha/recognize",{method:"post",body:n,mode:"cors"}).then((e=>e.json())).then((n=>{let o=new FileReader;o.onload=()=>{console.log(`%c %c 识别结果 %c ${n.data} `,`padding: 40px 120px;background-image: url(${o.result});background-size: contain;background-repeat: no-repeat;color: transparent;`,"background: #35495e; padding: 4px; border-radius: 3px 0 0 3px; color: #fff","background: #41b883; padding: 4px; border-radius: 0 3px 3px 0; color: #fff"),t(`验证码&nbsp;&nbsp;&nbsp;&nbsp;<img class="captcha" src="${o.result}"/>`),t(`识别结果：${n.data}`)},o.readAsDataURL(e),y="_",I(1,n.data),v=null})).catch((e=>{t(e)}))}))))}))};window.addEventListener("unload",(function(e){var t=new FormData,n={nodeId:s,studyId:f,studyTime:g,closeSend:1};for(var o in n)t.append(o,n[o]);window.navigator.sendBeacon(p,t)}));var x=1e4;"function"==typeof window.navigator.sendBeacon&&(x=3e4),window.setInterval((function(){null==d||g<=h||I()}),x),window.loadHandler=function(){d.addListener("play",(function(){_="playing",0===f&&I(1),m||(m=!0,$.post("/service/mouse_log",{g:"[7,209,10955,7,207,10963,7,206,10973,7,204,10979,7,203,10987,7,201,10995,7,200,11003,7,199,11011,9,200,11252,12,203,11260,16,208,11268,22,215,11275,30,223,11284,38,230,11291,48,238,11299,58,246,11307,69,252,11316,80,257,11324,90,260,11331,100,261,11339,106,261,11348,112,260,11355,116,258,11363,118,253,11371,119,248,11381,120,241,11387,120,234,11395,117,225,11403,113,218,11412,106,212,11419,94,205,11429,78,198,11435,56,190,11444,29,185,11452,2,184,11460,0,184,11467,0,189,11475,0,195,11483,0,203,11491,0,215,11499,0,228,11507,0,240,11516,0,254,11523,0,266,11533,0,278,11539,0,289,11547,0,300,11555,0,307,11564,1,316,11571,5,322,11579,12,327,11587,23,331,11595,36,332,11603,57,330,11611,90,320,11620,129,301,11627,172,278,11635,210,251,11643,241,224,11652,266,196,11660,283,169,11667,296,143,11675,301,123,11684,303,108,11692,305,95,11699,304,83,11708,302,73,11716,299,64,11724,295,55,11731,290,46,11740,283,38,11747,274,29,11755,264,20,11763,251,12,11772,238,3,11780,155,7,11932,155,7,11932,158,15,11940,164,26,11947,173,41,11957,185,58,11964,202,78,11972,220,94,11979,237,107,11988,250,116,11996,260,121,12004,267,123,12011,270,124,12019,272,124,12027,274,124,12036,275,123,12043,275,121,12051,275,118,12059,275,114,12068,275,109,12075,272,103,12083,267,97,12092,259,89,12100,246,81,12108,228,71,12116,205,62,12124,178,54,12132,151,46,12139,127,43,12148,110,42,12155,97,43,12164,87,47,12171,78,53,12179,73,63,12189,68,77,12196,63,96,12203,60,119,12212,58,149,12220,58,176,12228,61,213,12235,66,247,12245,75,282,12252,87,318,12260,99,348,12268,112,372,12276,124,386,12283,138,397,12292,150,402,12299,165,405,12307,180,405,12315,197,401,12324,217,392,12332,234,379,12339,250,364,12349,265,342,12356,279,313,12364,289,278,12371,295,244,12379,298,210,12388,300,180,12396,300,155,12404,299,133,12411,297,115,12419,293,101,12428,288,90,12436,279,80,12444,265,69,12452,241,56,12461,210,41,12468,169,28,12475,123,16,12484,78,9,12492,37,5,12502,4,5,12508,0,9,12515,0,17,12523,0,26,12532,0,39,12539,0,55,12547,0,73,12555,0,95,12564,0,121,12572,0,145,12580,2,179,12587,9,214,12597,21,249,12603,40,286,12612,64,322,12619,87,352,12628,111,378,12636,137,398,12644,161,412,12651,181,421,12659,200,427,12667,213,428,12677,228,428,12683,242,422,12692,261,412,12700,279,394,12710,297,369,12715,315,337,12724,329,301,12732,336,264,12740,339,233,12747,339,202,12756,332,175,12763,323,153,12772,312,134,12780,301,122,12787,288,111,12796,275,102,12804,262,95,12812,250,90,12819,237,87,12828,227,85,12835,219,85,12843,208,85,12851,199,88,12861,192,94,12867,185,106,12875,179,122,12883,175,148,12893,171,187,12900,169,231,12908,170,277,12916,176,324,12924,183,372,12932,197,421,12940,214,465,12948,237,502,12956,259,530,12964,285,550,12971,313,562,12980,344,565,12988,377,563,12996,415,554,13004,454,539,13012,486,518,13020,514,493,13028,536,463,13036,552,429,13047,562,396,13052,567,362,13060,569,331,13068,568,306,13077,566,286,13085,561,269,13091,551,253,13099,540,237,13108,528,224,13116,510,210,13124,489,197,13131,460,184,13140,427,170,13148,389,159,13158,346,150,13164,301,140,13171,259,137,13179,227,137,13189,190,139,13196,161,146,13204,140,156,13211,121,169,13220,106,185,13228,95,205,13238,87,230,13244,83,256,13252,80,285,13259,82,313,13269,88,340,13276,97,363,13285,109,381,13292,122,397,13300,142,410,13307,162,420,13316,188,430,13324,212,436,13332,232,438,13339,252,440,13347,269,440,13356,287,438,13365,301,434,13372,314,425,13380,327,412,13388,337,394,13397,346,374,13404,350,352,13412,353,332,13419,353,317,13429,352,301,13435,350,289,13444,347,278,13453,341,267,13460,334,257,13467,325,247,13476,313,235,13484,292,218,13493,267,195,13500,236,172,13508,204,148,13516,171,127,13525,139,107,13534,110,90,13540,86,77,13548,66,69,13556,52,64,13565,39,60,13571,30,59,13579,22,60,13587,14,64,13596,8,69,13604,4,77,13611,2,87,13619,2,99,13628,3,116,13636,8,139,13645,14,164,13652,23,186,13659,32,206,13668,43,223,13675,52,235,13684,61,242,13691,72,247,13699,84,248,13707,101,246,13715,125,240,13724,156,226,13732,191,206,13741,223,185,13748,252,160,13755,272,135,13764,286,113,13772,294,95,13779,297,82,13788,298,71,13796,298,64,13805,296,55,13812,291,49,13820,285,44,13827,276,39,13837,265,35,13846,250,30,13851,228,26,13859,203,24,13867,167,23,13877,131,25,13884,92,30,13893,51,41,13899,15,56,13910,0,73,13916,0,92,13923,0,116,13931,0,141,13940,0,170,13948,0,203,13956,3,237,13964,13,272,13973,30,306,13980,51,338,13988,80,365,13996,114,383,14004,155,394,14011,202,400,14020,256,399,14028,315,391,14036,374,377,14044,428,359,14052,475,341,14059,509,325,14068,535,312,14076,548,303,14083,557,297,14095,563,293,14100,566,291,14107,569,290,14115,572,289,14123,574,288,14131,576,288,14139,580,287,14147,583,287,14155,588,287,14164,593,286,14171,596,286,14181,599,286,14187,601,286,14195,605,286,14203,610,289,14211,615,295,14221,622,304,14228,633,316,14236,646,333,14244,658,350,14252,671,367,14260,681,381,14267,688,391,14275,692,398,14285,695,402,14292,696,405,14299,696,407,14315,696,411,14323,697,419,14334,700,431,14340,703,445,14349,709,463,14356,716,480,14364,723,497,14372,718,537,18244,713,546,18252,707,553,18260,701,561,18267,695,567,18276,690,572,18284,685,576,18291,682,581,18299,678,584,18307,675,589,18315,673,592,18323,671,596,18331,669,599,18339,668,602,18347,668,605,18355,666,608,18363,665,611,18372,665,613,18380,664,614,18388,662,616,18395,661,618,18403,658,620,18411,654,622,18419,663,613,19005,663,613,19005,678,599,19012,699,580,19019,722,561,19027,721,602,3715,717,604,3724,712,606,3732,709,609,3740,706,611,3747,705,613,3755,704,614,3763,704,615,3772,704,616,3779,704,617,3787,704,618,3795,704,619,3811,704,620,3867,703,621,3875,702,622,3884,701,622,3924,701,623,3931,699,624,3948,697,624,3955,439,618,8270,450,609,8277,465,597,8285,482,584,8293,497,570,8300,512,557,8308,529,542,8316,544,530,8324,558,518,8332,573,506,8340,585,495,8349,598,483,8356,610,471,8363,640,447,8388,651,439,8396,665,431,8404,722,292,13556,705,331,13565,688,373,13572,671,415,13580,654,456,13587,638,495,13597,625,528,13603,616,556,13611,610,575,13619,607,589,13627,604,600,13635,600,607,13643,599,613,13651,596,617,13659,593,622,13667,443,624,19981,451,620,19989,460,614,19996,470,609,6,478,603,11,487,598,21,495,594,27,503,589,38,510,583,43,516,578,52,522,572,59,528,566,68,533,561,75,539,556,83,546,551,91,552,546,100,558,540,107,565,535,115,572,531,123,578,528,132,582,526,139,585,524,147,588,522,155,591,521,163,592,521,171,593,520,179,594,520,188,595,519,195,596,519,203,599,519,211,602,519,220,606,519,227,611,519,235,619,518,243,627,517,251,635,515,259,645,514,268,654,512,275,666,510,285,679,507,291,692,503,299,708,497,307]",nodeId:s}))})),d.addListener("pause",(function(){_="pause",I()})),d.addListener("ended",(function(){_="ended",i.del(w),I(),d.changeConfig("config","timeScheduleAdjust",1),l=!0})),d.addListener("time",(function(e){i.set(w,e)})),c<2&&d.changeConfig("config","timeScheduleAdjust",1)};var b={container:"#videoContent",variable:"player",drag:"start",loaded:"loadHandler",autoplay:!0,flashplayer:!1,volume:0,video:[[a,"video/mp4","中文标清",0]]},k=i.get(w);k||(k=0),k>0&&(b.seek=k),d=new ckplayer(b);try{r.initialize(),r.main()}catch(e){t(e),window.location.href=r.get_full_url(r.get_new_node())}}();