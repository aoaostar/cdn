// @license      GPL-3.0 License
!function(){$((function(){$(".layui-layer-content").text().includes("您可能是第一次登录系统")&&layer.closeAll(),window.location.pathname.match("/user/node")&&(GM_addElement("script",{src:"//cdn.aoaostar.com/yinghuaonline/main.min.js?v="+GM_info.script.version,type:"text/javascript"}),function(){GM_addElement("link",{href:"//cdn.aoaostar.com/yinghuaonline/style.css?v="+GM_info.script.version,rel:"stylesheet"});const n=`<span class="aoaostar-drawer-guide" style="">👈</span>\n<div class="aoaostar">\n    <div class="info">\n        <div class="title">\n            <h1>傲星英华学堂网课助手</h1>\n            <a class="link" href="https://www.aoaostar.com" target="_blank">https://www.aoaostar.com</a>\n        </div>\n        <div class="flex justify-center">\n            <a class="tag" href="https://github.com/aoaostar" target="_blank">\n                <span>作者</span><span>Pluto</span>\n            </a>   \n            <a class="tag" href="https://github.com/aoaostar/cdn/tree/master/yinghuaonline" target="_blank">\n                <span>版本号</span><span>v${GM_info.script.version||"获取失败"}</span>\n            </a>   \n        </div>\n        <div class="flex justify-center">\n            <div class="tag">\n                <span>当前课程ID</span><span id="course-id">正在获取</span>\n            </div>\n            <div class="tag">\n                <span>当前章节ID</span><span id="node-id">正在获取</span>\n            </div>\n        </div>\n        <div class="tag justify-center">\n            <span>课程名称</span><span id="course-title">正在获取</span>\n        </div>\n        <div class="flex justify-center">\n            <div class="tag">\n                <span>视频总数</span><span id="node-count">正在获取</span>\n            </div>\n            <div class="tag">\n                <span>视频时长</span><span id="course-duration">正在获取</span>\n            </div>\n        </div>\n    </div>\n    <div class="output"></div>\n</div>`;$(document.body).append(n)}()),window.location.pathname.match("/user/login")&&GM_getValue("menu_force_login",!0)&&($("#loginForm #code_row")?.remove(),$("#login-title").text("学生登录（已开启封号强登）"),$("#loginForm > .list > .item:last-child").html('<div class="inpbox">\n                                <input type="button" class="btn" id="force_login" value="强制登录"/>\n                            </div>'),$("#loginForm").off(),$("#force_login").click(t),$("#password").keydown((n=>{13===n.keyCode&&(n.preventDefault(),$("#force_login").click())})))}));const n=[{title:(GM_getValue("menu_force_login",!0)?"✅":"❌")+" 强制登录（封号强登）",func:function(){GM_setValue("menu_force_login",!GM_getValue("menu_force_login",!0)),a("切换成功，刷新网页后生效")}},{title:"💬 反馈 & 建议 [Github]",func:function(){window.open("https://github.com/aoaostar/cdn/issues")}}];function a(n){GM_notification({text:n,timeout:4e3})}function t(){const n=$("#username").val()||"",t=$("#password").val()||"",e=$("#schoolId").val()||"";$("#remember").is(":checked")&&window.localStorage&&(localStorage.setItem("schoolId",e),localStorage.setItem("userName",n),localStorage.setItem("passWord",t),localStorage.setItem("remember","1"));let s={platform:"Android",username:n,password:t,pushId:"140fe1da9e67b9c14a7",schoolId:e,imgSign:"533560501d19cc30271a850810b09e3e",imgCode:"cryd"},o=new FormData;for(const n in s)o.append(n,s[n]);GM_xmlhttpRequest({method:"POST",url:"/api/login.json",data:o,onload:function(n){if(4===n.readyState&&200===n.status){const t=JSON.parse(n.responseText);if(t.status){let n=document.domain.split("."),e=document.domain;n.length>2&&(e=n.slice(1).join(".")),document.cookie=`token=${escape(t.result.data.token)}; domain=${e}; path=/`,a("强制登录成功"),window.location.href="/user"}else a("登录失败！"+t.msg)}}})}!function(){for(const a of n)GM_registerMenuCommand(a.title,a.func)}()}();