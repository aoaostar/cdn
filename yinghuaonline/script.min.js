// @license      GPL-3.0 License
!function(){$((function(){window.location.pathname.match("/user/node")&&GM_addElement("script",{src:"//cdn.aoaostar.com/yinghuaonline/main.min.js?v="+(new Date).getTime(),type:"text/javascript"}),window.location.pathname.match("/user/login")&&GM_getValue("menu_force_login",!0)&&(document.querySelector("#loginForm #code_row")?.remove(),document.querySelector("#login-title").innerText="学生登录（已开启封号强登）",document.querySelector("#loginForm > .list > .item:last-child").innerHTML='<div class="inpbox">\n                                <input type="button" class="btn" id="force_login" value="强制登录"/>\n                            </div>',$("#loginForm").off(),document.getElementById("force_login").onclick=t)}));const e=[{title:(GM_getValue("menu_force_login",!0)?"✅":"❌")+" 强制登录（封号强登）",func:function(){GM_setValue("menu_force_login",!GM_getValue("menu_force_login",!0)),o("切换成功，刷新网页后生效")}},{title:"💬 反馈 & 建议 [Github]",func:function(){window.open("https://github.com/aoaostar/cdn/issues")}}];function o(e){GM_notification({text:e,timeout:4e3})}function t(){const e=$("#username").val()||"",t=$("#password").val()||"",n=$("#schoolId").val()||"";$("#remember").is(":checked")&&window.localStorage&&(window.localStorage.setItem("schoolId",n),window.localStorage.setItem("userName",e),window.localStorage.setItem("passWord",t),window.localStorage.setItem("remember","1"));let i={platform:"Android",username:e,password:t,pushId:"140fe1da9e67b9c14a7",schoolId:n,imgSign:"533560501d19cc30271a850810b09e3e",imgCode:"cryd"},a=new FormData;for(const e in i)a.append(e,i[e]);GM_xmlhttpRequest({method:"POST",url:"/api/login.json",data:a,onload:function(e){if(4===e.readyState&&200===e.status){const t=JSON.parse(e.responseText);if(t.status){let e=document.domain.split("."),n=document.domain;e.length>2&&(n=e.slice(1).join(".")),document.cookie=`token=${escape(t.result.data.token)}; domain=${n}; path=/`,o("强制登录成功"),window.location.href="/user"}else o("登录失败！"+t.msg)}}})}!function(){for(const o of e)GM_registerMenuCommand(o.title,o.func)}()}();